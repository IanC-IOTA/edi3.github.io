<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>edi3 Inter Customs Ledger 0.1.0 Specification - edi3 Standards by edi3</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/style.css">

    <link rel="apple-touch-icon" sizes="57x57" href="/images/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/images/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/images/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png">
    <link rel="manifest" href="/images/favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/images/favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
</head>

<body>

<header class="header">
    <div class="header-line">
        <div class="wrapper">
            <div id="mobile-menu-wrapper" class="mobile-menu">
                <button id="hamburger-menu" class="hamburger-menu">
                    <span>toggle menu</span>
                </button>
                <div id="mobile-menu" style="display: none;">
                    
                    <ul class="sidebar-menu">
    
    <li class="menu-title"><a href="/">Overview</a></li>
    <li><a  href="/governance/">Governance</a></li>
    <li><a  href="/business-case/">Business Case</a></li>
    <li><a  href="/glossary/">UN/CEFACT Glossary</a></li>
    <li class="menu-title"><a href="/semantic-specs/">Semantic Specs</a></li>
    <li><a  href="/trade/">Trade Domain</a></li>
    <li><a  href="/transport/">Transport Domain</a></li>
    <li><a  href="/regulatory/">Regulatory Domain</a></li>
    <li><a  href="/finance/">Finance Domain</a></li>
    <li><a  href="/unlocode/">UN Locode</a></li>
    <li><a  href="/codelists/">Code Lists</a></li>
    <li><a  href="/dictionary/">Dictionary</a></li>
    <li class="menu-title"><a href="/technical-specs/">Technical Specs</a></li>
    <li><a  href="/icl/">Inter Customs Ledger</a></li>
    <li><a  href="/identity/">Identity Provider</a></li>
    <li><a  href="/discovery/">Resource Discovery</a></li>
    <li><a  href="/description/">Resource Description</a></li>
    <li><a  href="/events/">Event Structure</a></li>
    <li><a  href="/notary/">Notary Service</a></li>
    <li class="menu-title"><a href="/tools-and-methods/">Tools and Methods</a></li>
    <li><a  href="/uml-profile/">UML Profile</a></li>
    <li><a  href="/api-ndr/">OpenAPI NDR</a></li>
    <li><a  href="/json-ld-ndr/">JSON-LD NDR</a></li>
    <li><a  href="/api-conformance/">API Conformance</a></li>
    <li><a  href="/model-interchange/">Model Interchange</a></li>
    <li class="menu-title"><a href="/community/">Community</a></li>
    <li><a href="http://eepurl.com/dMLfdU" target="_blank">Newsletter (subscribe)</a></li>
    <li><a href="https://join.slack.com/t/edi3/shared_invite/enQtNTY5OTkzMjQ0NjcyLTM1MzYyNjg5M2RlMWIyZjUzMDBlNWQ3OWIyZTNhMDhhN2UzYjIyMjk4M2VhM2ViNzhhM2Y1OWE0Y2FhYTc1ZTg" target="_blank">Chat (join team)</a></li>
    <li><a  href="/github/">GitHub</a></li>
</ul>

                </div>
            </div>
            <a href="/" class="logo"><img src="/images/logo-horisontal-white.svg" alt="edi3"></a>
            <div class="header-search">
                <script>
                    (function() {
                        var cx = '002841699265932723855:7gvs7wrhud8';
                        var gcse = document.createElement('script');
                        gcse.type = 'text/javascript';
                        gcse.async = true;
                        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                        var s = document.getElementsByTagName('script')[0];
                        s.parentNode.insertBefore(gcse, s);
                    })();
                </script>
                <gcse:search></gcse:search>
            </div>
            
        </div>
    </div>
    <div class="header-content">
        <div class="wrapper">
            <div class="header-text-box">
                <div class="header-name">edi3 Standards</div>
                <div class="header-tagline">UN/CEFACT Standards for Web Developers</div>
            </div>
        </div>
    </div>
</header>
<script type="text/javascript">
    document.getElementById('hamburger-menu').onclick = function() {
        var nf = document.getElementById('mobile-menu');

        // Show and hide menu items when toggle is clicked
        if(nf.style.display==='none') {
            nf.style.display = 'block';
        }
        else {
            nf.style.display = 'none';
        }
    };

    window.addEventListener('click', function(e){
        if (!document.getElementById('mobile-menu-wrapper').contains(e.target)){
            document.getElementById('mobile-menu').style.display= 'none';
        }
    });
</script>

<div class="main-wrapper">
    <div class="main-content">
        <div class="page-sidebar">
            <ul class="sidebar-menu">
    
    <li class="menu-title"><a href="/">Overview</a></li>
    <li><a  href="/governance/">Governance</a></li>
    <li><a  href="/business-case/">Business Case</a></li>
    <li><a  href="/glossary/">UN/CEFACT Glossary</a></li>
    <li class="menu-title"><a href="/semantic-specs/">Semantic Specs</a></li>
    <li><a  href="/trade/">Trade Domain</a></li>
    <li><a  href="/transport/">Transport Domain</a></li>
    <li><a  href="/regulatory/">Regulatory Domain</a></li>
    <li><a  href="/finance/">Finance Domain</a></li>
    <li><a  href="/unlocode/">UN Locode</a></li>
    <li><a  href="/codelists/">Code Lists</a></li>
    <li><a  href="/dictionary/">Dictionary</a></li>
    <li class="menu-title"><a href="/technical-specs/">Technical Specs</a></li>
    <li><a  href="/icl/">Inter Customs Ledger</a></li>
    <li><a  href="/identity/">Identity Provider</a></li>
    <li><a  href="/discovery/">Resource Discovery</a></li>
    <li><a  href="/description/">Resource Description</a></li>
    <li><a  href="/events/">Event Structure</a></li>
    <li><a  href="/notary/">Notary Service</a></li>
    <li class="menu-title"><a href="/tools-and-methods/">Tools and Methods</a></li>
    <li><a  href="/uml-profile/">UML Profile</a></li>
    <li><a  href="/api-ndr/">OpenAPI NDR</a></li>
    <li><a  href="/json-ld-ndr/">JSON-LD NDR</a></li>
    <li><a  href="/api-conformance/">API Conformance</a></li>
    <li><a  href="/model-interchange/">Model Interchange</a></li>
    <li class="menu-title"><a href="/community/">Community</a></li>
    <li><a href="http://eepurl.com/dMLfdU" target="_blank">Newsletter (subscribe)</a></li>
    <li><a href="https://join.slack.com/t/edi3/shared_invite/enQtNTY5OTkzMjQ0NjcyLTM1MzYyNjg5M2RlMWIyZjUzMDBlNWQ3OWIyZTNhMDhhN2UzYjIyMjk4M2VhM2ViNzhhM2Y1OWE0Y2FhYTc1ZTg" target="_blank">Chat (join team)</a></li>
    <li><a  href="/github/">GitHub</a></li>
</ul>

        </div>
        <div class="page-content docs-content">
            
            <div class="spec-header">
                
                <ul>
                    <li>Spec ID: <p>icl/1</p>
</li>
                    <li><p><img src="http://rfc.unprotocols.org/spec:2/COSS/raw.svg" alt="raw" /></p>
</li>
                    <li>Editor: <p><a href="mailto:christopher.d.gough@gmail.com">Chris Gough</a></p>
</li>
                    <li>Contributors: <p><a href="https://github.com/arpentnoir">Richard Spellman</a></p>
</li>
                </ul>
            </div>
            <div class="specs-toc">
    <!--<div class="specs-toc-title">Table of contents</div>-->
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#licence">Licence</a></li>
<li class="toc-entry toc-h2"><a href="#change-process">Change Process</a></li>
<li class="toc-entry toc-h2"><a href="#language">Language</a></li>
<li class="toc-entry toc-h2"><a href="#abstract">Abstract</a></li>
<li class="toc-entry toc-h2"><a href="#glossary">Glossary</a></li>
<li class="toc-entry toc-h2"><a href="#other-projects">Other Projects</a></li>
<li class="toc-entry toc-h1"><a href="#icl-requirements">ICL Requirements</a>
<ul>
<li class="toc-entry toc-h2"><a href="#business-context">Business Context</a></li>
<li class="toc-entry toc-h2"><a href="#architectural-principles">Architectural Principles</a></li>
<li class="toc-entry toc-h2"><a href="#high-level-requirements">High Level Requirements</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#icl-technical-specification">ICL Technical Specification</a>
<ul>
<li class="toc-entry toc-h2"><a href="#architecture-overview">Architecture Overview</a></li>
<li class="toc-entry toc-h2"><a href="#information-and-security-architecture">Information and Security Architecture</a></li>
<li class="toc-entry toc-h2"><a href="#generic-process-flow">Generic Process Flow</a></li>
<li class="toc-entry toc-h2"><a href="#icl-api-specifications">ICL API Specifications</a>
<ul>
<li class="toc-entry toc-h3"><a href="#document-api--acl">Document API &amp; ACL</a></li>
<li class="toc-entry toc-h3"><a href="#channel-txrx-api">Channel Tx/Rx API</a></li>
<li class="toc-entry toc-h3"><a href="#subscriptions-api">Subscriptions API</a></li>
<li class="toc-entry toc-h3"><a href="#channel-api">Channel API</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#icl-security-architecture">ICL Security Architecture</a>
<ul>
<li class="toc-entry toc-h3"><a href="#icl-node-user-identity">ICL Node User Identity</a></li>
<li class="toc-entry toc-h3"><a href="#in-country-identity-schemes">In Country Identity Schemes</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#icl-distributed-ledger-channels">ICL Distributed Ledger Channels</a>
<ul>
<li class="toc-entry toc-h3"><a href="#ethereum-mapping">Ethereum Mapping</a></li>
<li class="toc-entry toc-h3"><a href="#hyperledger-fabric-mapping">Hyperledger Fabric Mapping</a></li>
<li class="toc-entry toc-h3"><a href="#hyperledger-sawtooth-mapping">Hyperledger Sawtooth Mapping</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#icl-business-applications">ICL Business Applications</a>
<ul>
<li class="toc-entry toc-h2"><a href="#semantic-overview">Semantic Overview</a></li>
<li class="toc-entry toc-h2"><a href="#origin-data-example">Origin Data Example</a></li>
</ul>
</li>
</ul>
</div>
            <h2 id="licence">Licence</h2>

<p>All material published on edi3.org including all parts of this specification are the intellectual property of the UN as per the <a href="https://www.unece.org/fileadmin/DAM/cefact/cf_plenary/plenary12/ECE_TRADE_C_CEFACT_2010_20_Rev2E_UpdatedIPRpolicy.pdf">UN/CEFACT IPR Policy</a>.</p>

<p>This Specification is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version. See http://www.gnu.org/licenses.</p>

<h2 id="change-process">Change Process</h2>

<p>This document is governed by the <a href="http://rfc.unprotocols.org/spec:2/COSS/">2/COSS</a> (COSS).</p>

<h2 id="language">Language</h2>

<p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” 
in this document are to be interpreted as described in RFC 2119.</p>

<h2 id="abstract">Abstract</h2>

<p>This document describes a technical specification for the trusted transfer of cross-border regulatory documents between government agencies using distributed ledger technology. The use of a distributed ledger approach for G2G document sharing offers several advantages over alternative methods.</p>

<ul>
  <li>There is no centralised infrastructure - thereby avoiding the need for complex funding models and avoiding a single point of failure or security risk.</li>
  <li>Each country can host trade documents within their jurisdiction, conforming to increasingly strict data soveriegnty rules.</li>
  <li>Trade documents can be notarised and verified with very high integrity against tampering or forgery.</li>
  <li>Where appropriate (eg single use certificates), documents as digital assets can be transfered and acquitted follwing the physical asset movement.</li>
</ul>

<p>There is no expectation that a single uber-ledger supports all G2G transactions. A apecific ledger may service as few as two countries and may be limited to a single process (eg certificates of origin and certificates of non-manipulation) or may service multiple coujntries and multiple processes. Therefore this specification supports the use of multiple different distributed ledgers (both public and private) by defining a standrdised protocol that allows users within a jurisdiction to interact with multiple ledgers via a simple interface.</p>

<p>This document uses Certificates of Origin and Certificates of Non-Manipulation as the guiding use case for the initial specification, however it is intended that the Inter Customs Ledger should be generic and allow for the transfer of any shipment related documentation between authorised agencies.</p>

<h2 id="glossary">Glossary</h2>

<p>To-do : replace this section with a simple link to role definitions in the dictionary specification</p>

<table>
  <thead>
    <tr>
      <th>Term</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>3PL</td>
      <td>Third Party Logistics Provider (eg freight forwarders)</td>
    </tr>
    <tr>
      <td>Agent</td>
      <td>Intermediaries such as customs agents</td>
    </tr>
    <tr>
      <td>API</td>
      <td>Application Programming Interface</td>
    </tr>
    <tr>
      <td>Carrier</td>
      <td>A provider of transport means/equiment such a shipping line or airline</td>
    </tr>
    <tr>
      <td>Certifying Body</td>
      <td>An organisation that has been accredited to issue one or more certificate types - such as a chamber of commerce or government agency that may issue Certificates of Origin</td>
    </tr>
    <tr>
      <td>DLT</td>
      <td>Distributed Ledger Technology, of which Blockchain is the most common example.</td>
    </tr>
    <tr>
      <td>Document</td>
      <td>When capitalised in this document, this term refers to any document which gives authorisation for an importer or exporter to take some action (or be granted some further authority) with respect to an international shipment of goods. e.g. a Certificate of Origin, a Phytosanitary Certificate, an Export Declaration, etc</td>
    </tr>
    <tr>
      <td>Exporter</td>
      <td>Business or individual that is the seller of internationally traded goods</td>
    </tr>
    <tr>
      <td>ICL Node</td>
      <td>A device on an ICL network which has full visibility of the entire ledger and contriibutes to the integrity of the ledger by implementing a Consensus Algorithm. Typically operated by a national regulator</td>
    </tr>
    <tr>
      <td>ICL User</td>
      <td>any of the above roles that interact with the ICL (typically via some software application)</td>
    </tr>
    <tr>
      <td>Importer</td>
      <td>Business or individual that is the buyer of internationally traded goods</td>
    </tr>
    <tr>
      <td>Regulator</td>
      <td>A government agnecy such as a customs authority</td>
    </tr>
  </tbody>
</table>

<h2 id="other-projects">Other Projects</h2>

<p>There have been a number of recent projects which use blockchain to implement a system which allows the validation of Certifiate of Origin issued under some Free Trade Agreement. Singapore and Kenya have both worked with industry parter vCargo Cloud to implement blockchain Certificate of Origin solutions. The first Certificate of Origin for a shipment from the UK was issued by {who?} in {month?} 2018 and in {when?} the United States were looking into the use of blockchain to validate Certificates of Origin for shipments made under {old agreements?}. These projects have highlighted the necessity for digital, blockchain based solutions to exist alongside paper based processes in the short term, requiring the continued existance of some mechanism for validating the authenticity of a paper certificate.</p>

<p>Before the prevalence of distributed ledger technology, the common approach to providing for assurance as to the validity of a Document was largely achieved with the idea of a hub. There are a number of implementations of this approach which may be instructive: ICC Certificate of Origin verification website, EPIX, IPCC ePhyto hub, etc.  However, solutions based on global hubs typically face difficulties finding a funding model and are often honey-pots of information for security attacks. Consequently, national regulators are increasingly reluctant to depend on centralised solutions.</p>

<p>The link below provides a number of resources which attempt to give an overview of the landscape of blockchain based projects related to both Certificates of Origin and International trade in general</p>

<p><a href="precedents.md">Survey of Blockchain Based Approaches to Managing International Trade Documentation</a></p>

<h1 id="icl-requirements">ICL Requirements</h1>

<h2 id="business-context">Business Context</h2>

<p>International trade clearance procedures require a number of documents to be presented to satisfy the requirements of a variety of agreements. For example, in order for an importer to gain preferential tariff treatment under a Free Trade Agreement, the importer must present a valid Certificate of Origin (issued to the exporter) which states that the goods being imported qualify as originating in the country which is party to the agreement. These processes are managed largely by the transfer of paper documents which are subject to loss, alteration and forgery.</p>

<p><img src="DocumentFlows_AsIs.png" alt="paper flows" /></p>

<p>In many jurisdictions, significant digitisation progress has been made for interactions between the national regulators (eg customs) and the local regulated community (eg importers, exporters, etc). In Australia for example, 99% of customs documents are already lodged electronically. However there still remains a very significant amout of paper documents that support cross border trade. The majority of the paper documents fit the same pattern; they are issued by a party in the exporting country but required by the regulator of the importing country for goods clearance. One significant reason that paper has been difficult to replace is that there is no direct trust relationshiop that allows in importing regulator to confirm the identity of the document issuer in the exporting jurisdiction.</p>

<p>An Inter Customs Ledger (ICL) is proposed as an apporach to the transfer of shipment related documents between customs agencies which is immediate, permanent and irrefutable.  The intercustoms ledger is essentially a trust bridge between national identity schemes - basically the importing regulator trusts the identity of the document issuer because the exporting regulator confirms the issuer identity.</p>

<p><img src="DocumentFlows_ToBe.png" alt="digital flows" /></p>

<p>The future state diagram shows the relationship between the ICL and three other key components.</p>

<ul>
  <li>National single windows and port community systems provide a streamlined and automated means for local entities (traders, 3PL, agents, etc) to interact with their local regulators. Many nations now have some kind of single window system but implementations are varied and usually unique to the local regualatory environment. The ICL can be thought of as a cross-border integration framerwork <em>between</em> national single windows.  However, it is important that the varied and complex national rules do not bleed into the ICL so that integration remains simple.</li>
  <li>National digital identity schemes are emerging in many jursdictions are provide a way for businesses and individuals in a country to prove their identity to any government agency and to any authorised non-government entity. Business identity schemes are typically linked to public tax registration numbers. Individual identities may be linked to a business identity and will normally include the idea of identity assurance levels which indicate the degree of identity integrity attached to the token holder. This means, for example, that a certificate of origin provided by an exporter to their local customs authority (possibly via a single window) can be passed to the importing authority together with a high integrity identity claim. In this way, the ICL is essentially an international “trust bridge” between national identity schemes.</li>
  <li>Commercial trade data platforms/pipelines are an emerging capability that seek to provide their customers with and-to-end supply chain visibility and management. They are essentially multi-source data aggregators and their scope usually includes some or all of trade, transport, financial, and regulatory data. The data managed by commerciasl pipleines is not only traditional trade documents (invoices, bills of lading etc) but also IoT streams like data feeds from instrumented smart containers. These platforms can provide significant value to their stakeholders and have a scope much larger than G2G data sharing. The ICL complements these commercial services and does not compete with them.</li>
</ul>

<h2 id="architectural-principles">Architectural Principles</h2>

<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Principle</th>
      <th>Rationale</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>P1</td>
      <td>Avoid bleeding any local regulatory complexities into cross-border processes</td>
      <td>A strong separation between local complexity and cross border document exchange is essential for scalability. The ICL specification must be as simple as possible in order for updake to scale.</td>
    </tr>
    <tr>
      <td>P2</td>
      <td>Support multiple distributed ledger types &amp; networks</td>
      <td>A single global uber-ledger would need to pick a technology winner, would restrict the ability to intruduce non breaking extensions, would present a high value attack target, and is unlilkely to be supported by every nation.</td>
    </tr>
    <tr>
      <td>P3</td>
      <td>Coexist nicely with paper processes</td>
      <td>A switch from paper processes to native digital documents exchanged via ICL will not happen overnight. Therefore the ICL shoiuld add value to existing paper processes and should facilitate a simple and gradual transitoin from paper to native digital documents.</td>
    </tr>
    <tr>
      <td>P4</td>
      <td>Leverage the unique position of national regulators</td>
      <td>Customs authorities enjoy a unique postion as the single convergence point for all imports to and exports from a country. That allows an intercustomes ledger to easily achieve complete coverage of bilateral or multilateral trading relationships.</td>
    </tr>
    <tr>
      <td>P5</td>
      <td>Complement rather than compete with commercial platforms</td>
      <td>Regulators are not natural innovators. The ideal ICL will provide a non-comptetitive platform that leverages the position to regualators to the benefit of their constituents whilst allowing comemrcial innovation to flourish.</td>
    </tr>
    <tr>
      <td>P6</td>
      <td>Do not <em>require</em> businesses to provide more than their local regulatory obligations demand.</td>
      <td>There may be genuine value to business in using the ICL for cross border processes beyond the regulatory minimum but regulators cannot and should not demand it. Therefore, ICL implementations should define a clear value propisition for every document that exceeds the regulatory minimum.</td>
    </tr>
    <tr>
      <td>P7</td>
      <td>Assume on-chain data is public</td>
      <td>The ICL may be implemented on either public ledgers such as etherium or private ledgers such as hyperledger. In either case, it should be assumed that on-chain data is public since even a private ledger has multiple nodes, each of which has a has a full copy and the privacy of on-chain data cannot be guaranteed.</td>
    </tr>
  </tbody>
</table>

<h2 id="high-level-requirements">High Level Requirements</h2>

<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Requirement</th>
      <th>Solution Links</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>R1</td>
      <td>The on-chain ICL data model MUST be simple enough to support any cross border use case.</td>
      <td>Link to ICL on-chain data model</td>
    </tr>
    <tr>
      <td>R2</td>
      <td>The on-chain ICL data SHOULD not contain sensitive or private information</td>
      <td>link to threat-risk analysis</td>
    </tr>
    <tr>
      <td>R3</td>
      <td>A message on the ICL SHOULD provide a mechanism for discovering the full content of the document to which it relates</td>
      <td>Link to discovery protocol</td>
    </tr>
    <tr>
      <td>R4</td>
      <td>Trade documents referenced by the ICL SHOULD be accessible via a consistent API</td>
      <td>Link to Repository API</td>
    </tr>
    <tr>
      <td>R5</td>
      <td>The ICL SHOULD NOT require that the user have any knowledge of the specific leger technology used (ehterium, hyperledger, etc)</td>
      <td>link to Message API</td>
    </tr>
    <tr>
      <td>R6</td>
      <td>The ICL SHOULD NOT assume that the user knows which ledger and which protocol to use in order to exchange a specific document type between two countries.</td>
      <td>Link to Routing API</td>
    </tr>
    <tr>
      <td>R7</td>
      <td>Any Regulator SHOULD be able to participate in the ICL by hosting an ICL Message API that integrates with one or more ledgers</td>
      <td>link to participation rules</td>
    </tr>
    <tr>
      <td>R8</td>
      <td>Participating in the network by hosting a Message API SHOULD NOT automatically grant access to the content of a document</td>
      <td>link to access control rules</td>
    </tr>
    <tr>
      <td>R9</td>
      <td>The ICL MUST provide a mechanism for preventing an importer or exporter from re-using a document which is intended to have a single use</td>
      <td>Link to smart contract patterns</td>
    </tr>
    <tr>
      <td>R10</td>
      <td>The ICL MUST provide some mechanism for asserting the validity of a document presented by an importer or exporter</td>
      <td>Link to notary / verification API</td>
    </tr>
    <tr>
      <td>R11</td>
      <td>The ICL MUST provide some mechanism for invalidating a Document</td>
      <td>Link to message API</td>
    </tr>
    <tr>
      <td>R12</td>
      <td>The ICL MUST provide some mechanism for specifying who can perform certain actions with respect to a Document</td>
      <td>Link to access control rules</td>
    </tr>
    <tr>
      <td>R13</td>
      <td>The ICL SHOULD allow any blockchgain technology to be used</td>
      <td>link to technology plug in architecture</td>
    </tr>
    <tr>
      <td>R14</td>
      <td>The ICL MUST allow transactions to be written individually or in bulk</td>
      <td>link to wire protocol / side tree architecture</td>
    </tr>
    <tr>
      <td>R15</td>
      <td>The ICL MUST provide a consistent means to support any G2G business process</td>
      <td>link to semantic layer architecture</td>
    </tr>
  </tbody>
</table>

<h1 id="icl-technical-specification">ICL Technical Specification</h1>

<h2 id="architecture-overview">Architecture Overview</h2>

<p>The ICL Specification comprises 5 standard APIs as shown (in yellow) in the conceptual architecture diagram below. The APIs are organised into three layers</p>

<ul>
  <li>The Channels layer represents the collection of compliant DLT solutions that can be used for cross-border document exchange. As an increasing number of DLT vendors support the channel API specification, so there will be an increasing number of channel options for ICL nodes.</li>
  <li>The ICL node layer represents the compomnents deployed by any country that wishes to participate in the inter-customs ledger. It provides an abstraction above specific DLT channels but remains agnoistic of specific cross-border business processes such as origin data exchange. This layer provides one or more secure document repositories (Document API) and implements the routing logic for recording channel transactions (Message API) and listening for relevant channel events (Subscriptions API).</li>
  <li>The applications layer represents any platform that will make use of the ICL for cross border exchange. THis is the business process specific layer and will typically be represented by single window applications or other trade &amp; logistics applications. The diagramn shows a CoO (Certifcate of Origin) API as an example but this lay coiuld support any trade document (invoice, Vill of Lading, etc).</li>
</ul>

<p><img src="ICL_API_Architecture.png" alt="API Architecture" /></p>

<p>ICL node implementations need access to routing information such as “to send document type X from Country A to Country B, use DLT channel 2”.  Initially it is expected that this information is managed independently in each node.  However as the number of countries, channels, and document types increases, there may be a requirement to manage routing information in a consistent way (which could be a centralised service or could be itself a decentralised ledger). Also, as countries make new arrangements (eg ceprecate one DLT channel in lieu of another) there will be a need to orchestrate the change without incurring downtime.</p>

<h2 id="information-and-security-architecture">Information and Security Architecture</h2>

<p>To-Do : Add some words about this diagram</p>

<p><img src="InformationAndSecurityArchitecture.png" alt="Information &amp; Security Architecture" /></p>

<h2 id="generic-process-flow">Generic Process Flow</h2>

<p>To-Do: Insert a sequence diagram here.  But the flow is something like:</p>

<p>Preconditions</p>

<ul>
  <li>Two or more countries (via one or more national or state regulators) have agreed on a specific ICL channel for one or more document types.</li>
  <li>Each authroised party (ie regulator) has also made available the repository URLs for each document type that they will host.</li>
  <li>public keys of authorised operators have been exchanged and mapped to persistent identities</li>
  <li>One or more business applications (eg trade single windows) in each country have integrated with theire respective national ICL nodes for the purposes of trusted cross-border exchange of documents.</li>
</ul>

<p>Cross-Border Sequence</p>

<p>The process starts when participant in the sender country uses a local business application (eg single window) to create a business document (eg a Certificate of Origin).</p>

<ol>
  <li>Sender country authority POSTS a document to the /documents API, which stores the document and returns a unique <a href="https://github.com/multiformats/multihash">multi-hash</a> ID.</li>
  <li>Sender country POSTS a message to the /messages Tx API from (sender) to (receiver) as a subject-predicate-object triple where each component of the triple conforms with a well defined vocabulary (ie the UN/CEFACT semantic library).  The object is the multi-hash of the document to be sent.</li>
  <li>ICL node POSTS the message to the correct distributed ledger channel via the channel API and, if the DLT channel successfully adda a new block to the chain, then a success response is returned to the ICL node.</li>
  <li>The ICL node updates the document api with access control information POST /documents/{id}/acl where acl is a list of recipients of the DLT message. Essentially the access control rule is “if we successfully sent you a message then you are allowed to access the corresponding document”.</li>
  <li>The receiving country is notified of a new message via the Message Rx API.</li>
  <li>The receiving country makes an authenticated request to the document API of the repository that hosts the document type that was received.  The document is retreived, the multi-hash recomputed and compared the that recorded on the ledger.</li>
  <li>The validated document is available to any locally authorised users of the recipient country business application layer.</li>
</ol>

<p>A user of a business application in the receiving country completes a hiogher level business process that is specific to the document type.  For example a customs authority may acquit a certificate of origin once goods have been received. The acquittal is also an ICL message that is sent back to the originator country.  The ICL network is essentially a high integrioty trusted pipe that can exchange any document and is not aware of the specifics of higher level business processes.</p>

<h2 id="icl-api-specifications">ICL API Specifications</h2>

<h3 id="document-api--acl">Document API &amp; ACL</h3>

<p>To-Do: Flesh this out.  But will be something like this:</p>

<p>B2G Binary Document POST</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST api.repository.gov.xx/documents/{binary file} 

returns 200 OK and multi-hash of file - eg "QmQtYtUS7K1AdKjbuMsmPmPGDLaKL38M5HYwqxW9RKW49n"
</code></pre></div></div>

<p>B2G JSON-LD Message POST</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST api.repository.gov.xx/metadata/{json file} 

returns 201 OK and multi-hash of file - eg "QEiCcvAfD+ZFyWDajqipYHKICkZiqQgudmbwOEx2fPiy+Rw"
</code></pre></div></div>

<p>B2G Message Status GET</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET api.repository.gov.xx/messages/{message Multi-hash} 

Returns status of blockchain consensus / commit. Sender can also subscribe to be notified.
</code></pre></div></div>

<p>G2G Update ACL after successful message send</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST api.repository.gov.xx/messages/{multi-hash}/acl/{identifier of message recipient}

returns 200 OK 
</code></pre></div></div>

<p>G2G Sometime later the recipient country retreives the document</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET api.repository.gov.xx/documents/{multi-hash}

returns 200 OK and the binary file identified by the multi-hash, assuming the requester is authenticated (ie presents a valid identity token) and authorised (ie the identity in the token is in the document API ACL for the specific document.)
</code></pre></div></div>

<h3 id="channel-txrx-api">Channel Tx/Rx API</h3>

<p>Once a document has been POSTed to the document API and a multi-hash is returned then POSTing the message to the sender country Message Tx API might look like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST api.icl.gov.xx/messages/{message}

where {message} is something like:
{
	"sender": "homeaffairs.gov.au", 
	"receiver": "customs.gov.cn", 
	"subject": "au.gov:abn:123456789", 
	"obj": "QmQtYtUS7K1AdKjbuMsmPmPGDLaKL38M5HYwqxW9RKW49n", 
	"predicate": "UN.CEFACT.Regulatory.CertificateOfOrigin.created"
}

response is 200 OK if the message is successfully processed by the relevant DLT channel
</code></pre></div></div>

<p>And the receiving country Message Rx API would get</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>something similar
</code></pre></div></div>

<h3 id="subscriptions-api">Subscriptions API</h3>

<p>We think subscriptions should just use <a href="https://www.w3.org/TR/websub/">W3C WebSub</a> - but will need to say something about standard WebSub event format.</p>

<h3 id="channel-api">Channel API</h3>

<p>After some routing discovery, the ICL node must submit the message to the relevant DLT channel.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>To be done
</code></pre></div></div>

<h2 id="icl-security-architecture">ICL Security Architecture</h2>

<p>There are two very distinct layers of users and corresponding identity assurance models.</p>

<ul>
  <li>ICL node users (ie users of the Document &amp; Message APIs) are a small number of regulatory authorities (typically customs) in each country. These are identified as part of an out-of-bounds key exchange mechanism. Most likely these will be extneded validation SSL certificates that identify the domain of the participant agency - eg homeaffairs.gov.au.</li>
  <li>In country participants (ie users of the application layer APIs) are a large number of organisations (or individuals) within a country that are creators or consumers of cross boder documents. These users are authenticated using an in-country identity verification regime such as Australian business authentication framework (VANguard). The identites contained in these in-country identity frameworks may be the {subject} value of the subject-predicate-object triple of the message API.</li>
</ul>

<h3 id="icl-node-user-identity">ICL Node User Identity</h3>

<p>to-do : more details here</p>

<h3 id="in-country-identity-schemes">In Country Identity Schemes</h3>

<p>to-do: more details here</p>

<h2 id="icl-distributed-ledger-channels">ICL Distributed Ledger Channels</h2>

<h3 id="ethereum-mapping">Ethereum Mapping</h3>

<h3 id="hyperledger-fabric-mapping">Hyperledger Fabric Mapping</h3>

<h3 id="hyperledger-sawtooth-mapping">Hyperledger Sawtooth Mapping</h3>

<h1 id="icl-business-applications">ICL Business Applications</h1>

<h2 id="semantic-overview">Semantic Overview</h2>

<h2 id="origin-data-example">Origin Data Example</h2>


            
        </div>
    </div>
</div>
<footer class="footer">
    <a href="/" class="footer-logo"><img src="/images/logo-horisontal-white.svg" alt=""></a>
    <ul class="footer-menu">
        <li><a href="http://edi3.org/about">About edi3</a></li>
        <li><a href="https://github.com/edi3" target="_blank">Github</a></li>
        <li><a href="http://eepurl.com/dMLfdU" target="_blank">Newsletter</a></li>
        <li><a href="https://join.slack.com/t/edi3/shared_invite/enQtNTY5OTkzMjQ0NjcyLTM1MzYyNjg5M2RlMWIyZjUzMDBlNWQ3OWIyZTNhMDhhN2UzYjIyMjk4M2VhM2ViNzhhM2Y1OWE0Y2FhYTc1ZTg" target="_blank">Join</a> <a href="https://edi3.slack.com/messages/general/" target="_blank">team</a></li>
    </ul>
    <div class="footer-credits">
        This page was generated by GitHub Pages.
        Comments, issues and suggestions are welcome in the <a href="https://github.com/edi3/edi3.github.io/issues/new">ticket system</a>.
        Pull requests welcome in the <a href="https://github.com/edi3/edi3.github.io/">site repository</a>.
    </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-135810483-1', 'auto');
  ga('send', 'pageview');

</script>

<script src="/js/anchor.min.js"></script>
<script>
    anchors.add('h1, h2, h3, h4, h5');
    anchors.remove('.no-anchor, .page-content > h1:first-child');
</script>
</body>
</html>